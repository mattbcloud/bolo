<!DOCTYPE html>
<html>
<head>
<title>Bolo - Multiplayer Tank Warfare</title>
<link rel="shortcut icon" href="images/favicon.png">
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/themes/base/jquery.ui.all.css">
<link rel="stylesheet" href="css/bolo.css">
<link rel="stylesheet" href="css/jquery.ui.theme.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

<!-- Configure Railway server for multiplayer -->
<script>
// Override WebSocket to redirect to Railway server
window.BOLO_SERVER = 'web-production-7b7f6.up.railway.app';
window.BOLO_USE_WSS = true;

(function() {
  var OriginalWebSocket = window.WebSocket;
  window.WebSocket = function(url, protocols) {
    console.log('WebSocket original URL:', url);
    console.log('Current hostname:', window.location.hostname);

    // If connecting to github.io, redirect to Railway server
    if (window.location.hostname.indexOf('github.io') >= 0) {
      // Extract path from WebSocket URL
      var path = '/demo';  // Default path
      try {
        // Parse the WebSocket URL to get the path
        var urlObj = new URL(url);
        path = urlObj.pathname + urlObj.search;
      } catch (e) {
        // If URL parsing fails, try to extract path manually
        var matches = url.match(/(?:ws|wss):\/\/[^\/]+(\/.*)/);
        if (matches && matches[1]) {
          path = matches[1];
        }
      }

      var protocol = window.BOLO_USE_WSS ? 'wss://' : 'ws://';
      url = protocol + window.BOLO_SERVER + path;
      console.log('Redirecting WebSocket to Railway:', url);
    }
    return new OriginalWebSocket(url, protocols);
  };
})();
</script>

<script src="js/bolo-bundle.js"></script>
<script>
$(function() {
  var World = BoloWorld;
  world = new World();
  world.start();
});
</script>
</head>
<body></body>
</html>
